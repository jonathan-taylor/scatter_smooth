{"version":3,"kind":"Notebook","sha256":"ea605a89aae8e7d970d57e9c7b46b9f664480006de1ba2c810df0787a099640e","slug":"theory","location":"/theory.md","dependencies":[],"frontmatter":{"title":"Smoothing Splines: Theory and Implementation","jupytext":{"formats":"md:myst","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.19.1"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Jonathan Taylor","given":"Jonathan","family":"Taylor"},"name":"Jonathan Taylor","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/executablebooks/jupyter-book","source_url":"https://github.com/executablebooks/jupyter-book/blob/main/docs/theory.md","edit_url":"https://github.com/executablebooks/jupyter-book/edit/main/docs/theory.md","exports":[{"format":"md","filename":"theory.md","url":"https://jonathan-taylor.github.io/smoothing_spline//build/theory-ef6a16f88ea0dbfc88d4e85ea207fe0c.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"This document outlines the theoretical background for the ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"eSUuga3zkH"},{"type":"inlineCode","value":"smoothing_spline","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"HehllRqhdP"},{"type":"text","value":" package, synthesizing concepts from ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"p0CPQCLc2i"},{"type":"emphasis","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The Elements of Statistical Learning","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"LKhlLTOlxF"}],"key":"FLYWTdxUEX"},{"type":"text","value":" (Hastie, Tibshirani, Friedman), specifically Chapter 5. It also discusses the implementation details (Reinsch form vs. Basis form) and compares the features with R’s ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"osQclLLByo"},{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"AghbUf1TrW"},{"type":"text","value":".","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"b7zjjWmKvv"}],"key":"SZrWRE02IY"},{"type":"heading","depth":2,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"1. The Smoothing Spline Problem","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"asvDGBogLU"}],"identifier":"id-1-the-smoothing-spline-problem","label":"1. The Smoothing Spline Problem","html_id":"id-1-the-smoothing-spline-problem","implicit":true,"key":"Oh6nzDXlUC"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"The goal of smoothing splines is to find a function ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"zSkOjk8axS"},{"type":"inlineMath","value":"f(x)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"ov1ICISzmR"},{"type":"text","value":" that fits the data ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"qZP0cN120a"},{"type":"inlineMath","value":"\\{(x_i, y_i)\\}_{i=1}^N","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><msubsup><mo stretchy=\"false\">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\{(x_i, y_i)\\}_{i=1}^N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1em;vertical-align:-0.2587em;\"></span><span class=\"mopen\">{(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">}</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hGVtAK46et"},{"type":"text","value":" well while remaining smooth. This is formulated as the minimization of a penalized residual sum of squares:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"lJEnTozQXP"}],"key":"Q3AmJ1DLeo"},{"type":"math","value":"\\min_{f} \\sum_{i=1}^N w_i (y_i - f(x_i))^2 + \\lambda \\int [f''(t)]^2 dt","position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>f</mi></munder><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><mo>∫</mo><mo stretchy=\"false\">[</mo><msup><mi>f</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup><mi>d</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">\\min_{f} \\sum_{i=1}^N w_i (y_i - f(x_i))^2 + \\lambda \\int [f&#x27;&#x27;(t)]^2 dt</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.3479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8882em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2222em;vertical-align:-0.8622em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span></span></span></span></span>","enumerator":"1","key":"hHadBXGivv"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"NYy28ThB0o"},{"type":"inlineMath","value":"\\lambda \\ge 0","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda \\ge 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"N3gpAvPycH"},{"type":"text","value":" is a smoothing parameter and ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"zIQAU5pPRU"},{"type":"inlineMath","value":"w_i > 0","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">w_i &gt; 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"UEmk27VQq4"},{"type":"text","value":" are weights.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"e2VB6hO7JT"}],"key":"JMojq15tPt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\lambda = 0","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"QQAqbOxuQF"},{"type":"text","value":": ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Skeh7a0C7e"},{"type":"inlineMath","value":"f","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"DNX90T6qti"},{"type":"text","value":" becomes an interpolating spline (passes through every point).","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Lp6inmd9PO"}],"key":"zbdEP93m3J"}],"key":"qKfCY5zgcy"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\lambda \\to \\infty","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda \\to \\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"cfLBDkf5Ij"},{"type":"text","value":": ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"IcW1fjzXqZ"},{"type":"inlineMath","value":"f","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"cnKwwtt8Xq"},{"type":"text","value":" approaches the weighted linear least squares fit.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"ysqXOd6LF7"}],"key":"wv27VIupqR"}],"key":"rK252em5jE"}],"key":"J1lmsR6Gla"},{"type":"heading","depth":3,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"The Solution: Natural Cubic Spline","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"eK63kH4LGE"}],"identifier":"the-solution-natural-cubic-spline","label":"The Solution: Natural Cubic Spline","html_id":"the-solution-natural-cubic-spline","implicit":true,"key":"A0VWzwz5ee"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Remarkably, the solution to this infinite-dimensional optimization problem is a finite-dimensional ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"XKxVtpXzZN"},{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Natural Cubic Spline","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"AAAlMjqufC"}],"key":"JKkQMnPWJ9"},{"type":"text","value":" with knots at the unique values of ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"Zl0ZhYgGOK"},{"type":"inlineMath","value":"x_i","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"e0Hbn255DU"},{"type":"text","value":".","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"Byq7JPFpkG"}],"key":"kc0SBLiARi"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"A natural cubic spline is a piecewise cubic polynomial that is continuous up to its second derivative, and linear beyond the boundary knots (i.e., its second derivative is zero at the boundaries).","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"AOIyTvvRSt"}],"key":"B7gFCrvhuw"},{"type":"heading","depth":2,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"2. Matrix Formulation","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"ZbQpL3XfQc"}],"identifier":"id-2-matrix-formulation","label":"2. Matrix Formulation","html_id":"id-2-matrix-formulation","implicit":true,"key":"pmeg6XxF53"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Since the solution is a linear combination of basis functions, we can write:","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"bunZvLddm3"}],"key":"mNZyK23tv6"},{"type":"math","value":"f(x) = \\sum_{j=1}^N \\theta_j N_j(x)","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>θ</mi><mi>j</mi></msub><msub><mi>N</mi><mi>j</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x) = \\sum_{j=1}^N \\theta_j N_j(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.2421em;vertical-align:-1.4138em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"2","key":"CiMuMpLlel"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"WBznfAJhtU"},{"type":"inlineMath","value":"N_j(x)","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>j</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">N_j(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"pXyu9KZsVZ"},{"type":"text","value":" are the natural cubic spline basis functions.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"ii1IrIFWoT"}],"key":"IPQ21nLDSj"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"The optimization problem reduces to:","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"GMwN9fIDsX"}],"key":"OUTclMzwGW"},{"type":"math","value":"\\min_{ \\theta} (y - N \\theta)^T W (y - N \\theta) + \\lambda \\theta^T \\Omega_N \\theta","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>θ</mi></munder><mo stretchy=\"false\">(</mo><mi>y</mi><mo>−</mo><mi>N</mi><mi>θ</mi><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mi>W</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>−</mo><mi>N</mi><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>λ</mi><msup><mi>θ</mi><mi>T</mi></msup><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\min_{ \\theta} (y - N \\theta)^T W (y - N \\theta) + \\lambda \\theta^T \\Omega_N \\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.5021em;vertical-align:-0.7521em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.3479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7521em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Nθ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Nθ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0413em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span>","enumerator":"3","key":"VK94zi05MO"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"where:","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"M4jbiZaZlF"}],"key":"nsOxAFZBrW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":49,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"N_{ij} = N_j(x_i)","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>N</mi><mi>j</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">N_{ij} = N_j(x_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"dltYYSRoQk"},{"type":"text","value":" is the basis matrix.","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"fcxTvYb7f9"}],"key":"uSysUvv1Ii"}],"key":"YIftspHo33"},{"type":"listItem","spread":true,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"W = \\text{diag}(w_1, \\dots, w_N)","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>W</mi><mo>=</mo><mtext>diag</mtext><mo stretchy=\"false\">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>w</mi><mi>N</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W = \\text{diag}(w_1, \\dots, w_N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">diag</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"dcTMNzOR9a"},{"type":"text","value":" is the weight matrix.","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"AT5kl40uoV"}],"key":"FnxASnC47U"}],"key":"SbtOJd0gqU"},{"type":"listItem","spread":true,"position":{"start":{"line":51,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"(\\Omega_N)_{jk} = \\int N_j''(t) N_k''(t) dt","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><msub><mo stretchy=\"false\">)</mo><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><mo>∫</mo><msubsup><mi>N</mi><mi>j</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msubsup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><msubsup><mi>N</mi><mi>k</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msubsup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mi>d</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">(\\Omega_N)_{jk} = \\int N_j&#x27;&#x27;(t) N_k&#x27;&#x27;(t) dt</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">jk</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1998em;vertical-align:-0.3948em;\"></span><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4413em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3948em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4169em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"ZWKUEFwgan"},{"type":"text","value":" is the penalty matrix.","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"sJk2pN8dHB"}],"key":"gokGffzCCK"}],"key":"TTRDtu6SbW"}],"key":"bDRzlj8qVK"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"The solution is a generalized ridge regression:","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"ynpthxt0VV"}],"key":"k6a1wWGAeD"},{"type":"math","value":"\\hat{\\theta} = (N^T W N + \\lambda \\Omega_N)^{-1} N^T W y","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>θ</mi><mo>^</mo></mover><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>N</mi><mo>+</mo><mi>λ</mi><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\\hat{\\theta} = (N^T W N + \\lambda \\Omega_N)^{-1} N^T W y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9579em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>","enumerator":"4","key":"W0HLoWpjCA"},{"type":"heading","depth":3,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Reinsch Form vs. Basis Form","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"ufutRxnqeU"}],"identifier":"reinsch-form-vs-basis-form","label":"Reinsch Form vs. Basis Form","html_id":"reinsch-form-vs-basis-form","implicit":true,"key":"BOLBJE2SEn"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"There are three primary ways to compute the solution in our package:","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"ODxUnOvrK8"}],"key":"U02xdRpfuK"},{"type":"heading","depth":4,"position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"A. The Natural Spline Basis Form (","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"VE0uPbdSvW"},{"type":"inlineCode","value":"engine='natural'","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"HgSnvhhWCd"},{"type":"text","value":")","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"kTzYQYjVXB"}],"identifier":"a-the-natural-spline-basis-form-engine-natural","label":"A. The Natural Spline Basis Form (engine='natural')","html_id":"a-the-natural-spline-basis-form-engine-natural","implicit":true,"key":"dGoOCAFzoR"},{"type":"paragraph","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"We explicitly construct the basis matrix ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"EBwrjGYAgn"},{"type":"inlineMath","value":"N","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"rceh3Bc7sX"},{"type":"text","value":" and the penalty matrix ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"VxlszLiE1j"},{"type":"inlineMath","value":"\\Omega","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Ω</mi></mrow><annotation encoding=\"application/x-tex\">\\Omega</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Ω</span></span></span></span>","key":"Lj2BHxaTMr"},{"type":"text","value":".","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"Rotqc3ZSl7"}],"key":"PUXvDDvHBn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":64,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We use the property that a natural cubic spline is determined by its values and second derivatives at the knots.","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"WnJ9AW86Jb"}],"key":"A7aRirChRz"}],"key":"AmC4cVBFhH"},{"type":"listItem","spread":true,"position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Our C++ implementation constructs ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"hbJvXpwDli"},{"type":"inlineMath","value":"N","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"xoF5ZwOGO3"},{"type":"text","value":" efficiently by solving the tridiagonal system that relates second derivatives to values.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"CfKbXOOoHn"}],"key":"IUw1bGdWqg"}],"key":"uO7Ia1y6er"},{"type":"listItem","spread":true,"position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We then solve the linear system ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"x0e6SarDCV"},{"type":"inlineMath","value":"(N^T W N + \\lambda \\Omega)\\theta = N^T W y","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>N</mi><mo>+</mo><mi>λ</mi><mi mathvariant=\"normal\">Ω</mi><mo stretchy=\"false\">)</mo><mi>θ</mi><mo>=</mo><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">(N^T W N + \\lambda \\Omega)\\theta = N^T W y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\">Ω</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0358em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"DUyBnRidBZ"},{"type":"text","value":".","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"Zp3YUaGt1U"}],"key":"tYq75WmuGw"}],"key":"innd0GEU5H"},{"type":"listItem","spread":true,"position":{"start":{"line":67,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use of this is not recommended as it is much slower. It was written as part of the development process.","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"RqVn4QupRA"}],"key":"wYEVYJyUUx"}],"key":"xWtQtJqhHz"}],"key":"sgjncAN4ok"}],"key":"PU4cREfVwR"},{"type":"block","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"strong","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"Why Basis Form?","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"G4M9kbIQNT"}],"key":"IqOlK22NJC"}],"key":"fQpOhi7Vt6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":72,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Allows for ","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"ndLgPdUrJC"},{"type":"strong","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"Regression Splines","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"SltrBlNMHn"}],"key":"Hj6goq6hyC"},{"type":"text","value":": We can choose fewer knots than data points (","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"QFiiVo3NuF"},{"type":"inlineMath","value":"K < N","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>&lt;</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">K &lt; N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"qak23Gqf64"},{"type":"text","value":"). The math remains identical, but the matrices are smaller (","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"hCwpdp6aVA"},{"type":"inlineMath","value":"K \\times K","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>×</mo><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K \\times K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>","key":"RdzxCGppaT"},{"type":"text","value":" instead of ","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"znUjvxKSaV"},{"type":"inlineMath","value":"N \\times N","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N \\times N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"VHkyzr4TFd"},{"type":"text","value":").","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"MhIJtp0BFr"}],"key":"YMOTIIIclr"}],"key":"rDpENfa8AR"},{"type":"listItem","spread":true,"position":{"start":{"line":73,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Easier to extend to weighted least squares or other loss functions.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"emZ53LtHog"}],"key":"RitDOyZx8o"}],"key":"L2G19HhTLj"}],"key":"BUqhbgCkp6"},{"type":"heading","depth":4,"position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"B. The Reinsch Form (","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"Snx1TSuS3i"},{"type":"inlineCode","value":"engine='reinsch'","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"yMlxGcTlVq"},{"type":"text","value":")","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"LstDLiQ6M5"}],"identifier":"b-the-reinsch-form-engine-reinsch","label":"B. The Reinsch Form (engine='reinsch')","html_id":"b-the-reinsch-form-engine-reinsch","implicit":true,"key":"xwdG5lTSN1"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"If knots are placed at every data point (","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"bBSNcVA85Y"},{"type":"inlineMath","value":"K=N","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">K=N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"On9bBNn3aI"},{"type":"text","value":"), the solution vector ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"RCapbET2NZ"},{"type":"inlineMath","value":"\\mathbf{f} = (f(x_1), \\dots, f(x_N))^T","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>N</mi></msub><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f} = (f(x_1), \\dots, f(x_N))^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"DUwJCXk85Q"},{"type":"text","value":" can be found directly without forming ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"DqfJVoIseD"},{"type":"inlineMath","value":"N","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"YpF1dS70RP"},{"type":"text","value":".","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"Zz494MiFUZ"}],"key":"aT2nZeyUYQ"},{"type":"math","value":"\\hat{\\mathbf{f}} = (W + \\lambda K)^{-1} W y","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">f</mi><mo>^</mo></mover><mo>=</mo><mo stretchy=\"false\">(</mo><mi>W</mi><mo>+</mo><mi>λ</mi><mi>K</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>W</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{f}} = (W + \\lambda K)^{-1} W y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9579em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0833em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>","enumerator":"5","key":"M3Xzpt72NZ"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"uHZz0bSfWT"},{"type":"inlineMath","value":"K = Q R^{-1} Q^T","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo><mi>Q</mi><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>Q</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">K = Q R^{-1} Q^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0358em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"qViwWhNJOg"},{"type":"text","value":".","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"K4nJgBLdV8"}],"key":"dKC8xVLWYN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":81,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"Q","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"Qao2ETg0v2"},{"type":"text","value":" is an ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"QYDyOoaqqF"},{"type":"inlineMath","value":"N \\times (N-2)","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>×</mo><mo stretchy=\"false\">(</mo><mi>N</mi><mo>−</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">N \\times (N-2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span>","key":"bNk0QUsMGw"},{"type":"text","value":" tridiagonal matrix of second differences.","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"ZbDHmWIYfB"}],"key":"D7uAd1qgf2"}],"key":"vEJI0VmzoV"},{"type":"listItem","spread":true,"position":{"start":{"line":82,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"R","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>","key":"YT0xMEsa1l"},{"type":"text","value":" is an ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"TFDBqK2FUC"},{"type":"inlineMath","value":"(N-2) \\times (N-2)","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>N</mi><mo>−</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mo stretchy=\"false\">(</mo><mi>N</mi><mo>−</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(N-2) \\times (N-2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span>","key":"JdlZFqFq87"},{"type":"text","value":" tridiagonal matrix.","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"bYC4LEy1i8"}],"key":"hC6x8WTqmM"}],"key":"MfBLvUPurC"}],"key":"suc8N56pCg"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"This allows solving the system in ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"rv1073JFz8"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"Eg4eZfQEyR"},{"type":"text","value":" time using banded solvers, making it extremely fast for large ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"IRstaxXTyk"},{"type":"inlineMath","value":"N","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"qoRtqCslG5"},{"type":"text","value":". This matches the algorithm used in R’s ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"J1nzMTmQWZ"},{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"WctZvVF9wX"},{"type":"text","value":".","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"gEN4uICCEr"}],"key":"NWKz06ASJY"},{"type":"heading","depth":4,"position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"C. The B-Spline Basis Form (","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"wJG5NWBSt4"},{"type":"inlineCode","value":"engine='bspline'","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"DvABrHN8Tx"},{"type":"text","value":")","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"CzJ51RCp2V"}],"identifier":"c-the-b-spline-basis-form-engine-bspline","label":"C. The B-Spline Basis Form (engine='bspline')","html_id":"c-the-b-spline-basis-form-engine-bspline","implicit":true,"key":"w25NbJPA7J"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Uses the B-spline basis with compact support.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"bNTRD0Fdp4"}],"key":"ijUyD8o63p"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":88,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Constructs banded matrices for the normal equations ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"OUbgYiWXe3"},{"type":"inlineMath","value":"N^T W N","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N^T W N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"ikY4M2r2L4"},{"type":"text","value":" and ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"ySiYSTu4pP"},{"type":"inlineMath","value":"\\Omega_N","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\Omega_N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"w4skha0Q8C"},{"type":"text","value":".","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"VNTDtyPsdz"}],"key":"alEHDDKwgk"}],"key":"xOUebZ74FZ"},{"type":"listItem","spread":true,"position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Solves using LAPACK’s ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"BfFnn08XiL"},{"type":"inlineCode","value":"dpbsv","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"UwRbWnmvUH"},{"type":"text","value":" via ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"i9ZKJGHIzs"},{"type":"inlineCode","value":"scipy","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"owDBudZlbt"},{"type":"text","value":". This is the only part ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"osQJSk65qx"},{"type":"inlineCode","value":"scipy","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"GOTFTS3u4O"},{"type":"text","value":" is used so direct calls to LAPACK could in theory be used.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"GXLGtNHhVV"}],"key":"disL2ymKyh"}],"key":"mMQrx0HkT3"},{"type":"listItem","spread":true,"position":{"start":{"line":90,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Efficient for both ","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"q6o0tSSoed"},{"type":"inlineMath","value":"K=N","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">K=N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"jvtDU8p9Pu"},{"type":"text","value":" and ","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"qkfQSTl0QB"},{"type":"inlineMath","value":"K<N","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>&lt;</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">K&lt;N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"BI7z37Tzua"},{"type":"text","value":".","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"NBFHkvddVG"}],"key":"aJmtEd6OUi"}],"key":"I3v7xrfzqz"}],"key":"Ksj5oqlr0f"},{"type":"heading","depth":4,"position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"D. Automatic (","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"kCoNKw6PL6"},{"type":"inlineCode","value":"engine='auto'","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"mNxHS7w2p0"},{"type":"text","value":")","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"voTc1SXrVv"}],"identifier":"d-automatic-engine-auto","label":"D. Automatic (engine='auto')","html_id":"d-automatic-engine-auto","implicit":true,"key":"OiZTfbHHeR"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Uses Reinsch form if possible, else uses the B-Spline form.","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"T7VUB7o22p"}],"key":"katYyFK9Qd"},{"type":"heading","depth":2,"position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"3. Degrees of Freedom (","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"QhqGbK7eug"},{"type":"inlineMath","value":"df","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">df</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span></span></span></span>","key":"KA2yjZICZc"},{"type":"text","value":")","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"zrB9LM5pbe"}],"identifier":"id-3-degrees-of-freedom-df","label":"3. Degrees of Freedom (df)","html_id":"id-3-degrees-of-freedom-df","implicit":true,"key":"tmJqnjTxU4"},{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"The smoothing parameter ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"dcCD7XgmZA"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"ni5vIJThsV"},{"type":"text","value":" is abstract. A more intuitive measure of model complexity is the ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"M7nEhop1f2"},{"type":"strong","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"effective degrees of freedom (","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"ErfZR8wl49"},{"type":"inlineMath","value":"df","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">df</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span></span></span></span>","key":"sPdvOE4L59"},{"type":"text","value":")","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"D3hGX1Ir4o"}],"key":"q3wwcjqPtl"},{"type":"text","value":".","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"Ozrq3yPjKC"}],"key":"saUTkgWe22"},{"type":"math","value":"df(\\lambda) = \\text{trace}(\\mathbf{S}_\\lambda)","position":{"start":{"line":99,"column":1},"end":{"line":101,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mi>λ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mtext>trace</mtext><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">S</mi><mi>λ</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">df(\\lambda) = \\text{trace}(\\mathbf{S}_\\lambda)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">λ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">trace</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"6","key":"bZfSk7iVyV"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"onVL4G8cBV"},{"type":"inlineMath","value":"\\mathbf{S}_\\lambda","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">S</mi><mi>λ</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{S}_\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Uzgo6OD73c"},{"type":"text","value":" is the smoother matrix such that ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"Xt0v0mvKQf"},{"type":"inlineMath","value":"\\hat{y} = \\mathbf{S}_\\lambda y","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mo>=</mo><msub><mi mathvariant=\"bold\">S</mi><mi>λ</mi></msub><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\\hat{y} = \\mathbf{S}_\\lambda y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"YwvaW1VkKI"},{"type":"text","value":".","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"GtCR53zSJk"}],"key":"KgbsoeFs8a"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"For the Reinsch form, we compute the trace in ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"Bijz7PXSge"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"s3C6WA6iKM"},{"type":"text","value":" time using Takahashi’s equations (calculating selected elements of the inverse of a banded matrix via Cholesky decomposition).","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"AbmHPjon3d"}],"key":"Ay8TX6GO9E"},{"type":"paragraph","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"text","value":"For the Basis form (Natural), we compute the trace of the dense matrix inverse.","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"KxQaOZ4iMT"}],"key":"k2tUN2M1PG"},{"type":"paragraph","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"For the B-spline form, we also use Takahashi’s equations on the banded system to compute the trace efficiently in ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"cblTV0b2u7"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"AAtSxL7zDP"},{"type":"text","value":" time.","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"iwmjVSaKKd"}],"key":"J1ejmVhT5U"},{"type":"heading","depth":2,"position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"3.1. Details on Degrees of Freedom Computation","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"EcRlVelLce"}],"identifier":"id-3-1-details-on-degrees-of-freedom-computation","label":"3.1. Details on Degrees of Freedom Computation","html_id":"id-3-1-details-on-degrees-of-freedom-computation","implicit":true,"key":"zjqQKv9kEL"},{"type":"heading","depth":3,"position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"Trace of Inverse via Takahashi’s Algorithm","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"OFkoFIoiHC"}],"identifier":"trace-of-inverse-via-takahashis-algorithm","label":"Trace of Inverse via Takahashi’s Algorithm","html_id":"trace-of-inverse-via-takahashis-algorithm","implicit":true,"key":"LWSNuM9xPC"},{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Computing the degrees of freedom requires the trace of the smoother matrix ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"vByEgzmVvC"},{"type":"inlineMath","value":"S_\\lambda","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>λ</mi></msub></mrow><annotation encoding=\"application/x-tex\">S_\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jwUtrx9NxJ"},{"type":"text","value":". In the basis form:","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"sXAaF1sc21"}],"key":"rIOgI4iBbB"},{"type":"math","value":"\\hat{y} = N \\hat{\\theta} = N (N^T W N + \\lambda \\Omega_N)^{-1} N^T W y","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mo>=</mo><mi>N</mi><mover accent=\"true\"><mi>θ</mi><mo>^</mo></mover><mo>=</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>N</mi><mo>+</mo><mi>λ</mi><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\\hat{y} = N \\hat{\\theta} = N (N^T W N + \\lambda \\Omega_N)^{-1} N^T W y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9579em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>","enumerator":"7","key":"SSh3sj7p6y"},{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Thus, ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"OeglCBB3nb"},{"type":"inlineMath","value":"S_\\lambda = N (N^T W N + \\lambda \\Omega_N)^{-1} N^T W","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>S</mi><mi>λ</mi></msub><mo>=</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>N</mi><mo>+</mo><mi>λ</mi><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">S_\\lambda = N (N^T W N + \\lambda \\Omega_N)^{-1} N^T W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span></span>","key":"f4xtJoRYpe"},{"type":"text","value":". Using the cyclic property of the trace:","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"Z4Lvto2bAd"}],"key":"B4hQFDT4Zg"},{"type":"math","value":"\\text{df}(\\lambda) = \\text{trace}(S_\\lambda) = \\text{trace}((N^T W N + \\lambda \\Omega_N)^{-1} N^T W N)","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>df</mtext><mo stretchy=\"false\">(</mo><mi>λ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mtext>trace</mtext><mo stretchy=\"false\">(</mo><msub><mi>S</mi><mi>λ</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mtext>trace</mtext><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>N</mi><mo>+</mo><mi>λ</mi><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{df}(\\lambda) = \\text{trace}(S_\\lambda) = \\text{trace}((N^T W N + \\lambda \\Omega_N)^{-1} N^T W N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">df</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">λ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">trace</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">trace</span></span><span class=\"mopen\">((</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"8","key":"nERM8PM5Rz"},{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"K0o4H9JSvI"},{"type":"inlineMath","value":"A = N^T W N","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo>=</mo><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">A = N^T W N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"AYW5u47mDO"},{"type":"text","value":". We need to compute ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"ZpmP7q9vmW"},{"type":"inlineMath","value":"\\text{trace}((A + \\lambda \\Omega_N)^{-1} A)","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>trace</mtext><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><mi>A</mi><mo>+</mo><mi>λ</mi><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>A</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{trace}((A + \\lambda \\Omega_N)^{-1} A)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">trace</span></span><span class=\"mopen\">((</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span></span></span></span>","key":"qAITFynqu2"},{"type":"text","value":".","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"igFq72eoax"}],"key":"MS7fDGz52Y"},{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"For banded matrices (like those in our B-spline implementation), we can compute this trace efficiently in ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"EOBLKf3oth"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"y4h5NwAepO"},{"type":"text","value":" time without inverting the full matrix.","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"VjOu4sI8ZS"}],"key":"QGs6oaO4F6"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"Qxw6CzjhhF"},{"type":"inlineMath","value":"H = A + \\lambda \\Omega_N","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>λ</mi><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub></mrow><annotation encoding=\"application/x-tex\">H = A + \\lambda \\Omega_N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"t4fcw3JbHS"},{"type":"text","value":". We need ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"PxV7vjQTT8"},{"type":"inlineMath","value":"\\text{trace}(H^{-1} A)","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>trace</mtext><mo stretchy=\"false\">(</mo><msup><mi>H</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>A</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{trace}(H^{-1} A)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">trace</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span></span></span></span>","key":"P2rGHYeL9p"},{"type":"text","value":".\nSince ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"iuHXqXvOrc"},{"type":"inlineMath","value":"A","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"Z6cKHK75bf"},{"type":"text","value":" and ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"MXiXr0pcFN"},{"type":"inlineMath","value":"\\Omega_N","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\Omega_N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"pg1BnpBz3K"},{"type":"text","value":" are banded, ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"IP8PcOJvCu"},{"type":"inlineMath","value":"H","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"HAiR93t1UR"},{"type":"text","value":" is banded.\nLet ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"kCmBLpIkQZ"},{"type":"inlineMath","value":"H = U^T U","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mo>=</mo><msup><mi>U</mi><mi>T</mi></msup><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">H = U^T U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span>","key":"d994sYhllK"},{"type":"text","value":" be the Cholesky decomposition of ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"E4yxr1HU6y"},{"type":"inlineMath","value":"H","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"IxxIMN4adZ"},{"type":"text","value":", where ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"LAJR1XQ1r7"},{"type":"inlineMath","value":"U","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span>","key":"gclMhAwePS"},{"type":"text","value":" is an upper triangular banded matrix.\nWe need elements of ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"VRnYPl6M1r"},{"type":"inlineMath","value":"Z = H^{-1}","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi><mo>=</mo><msup><mi>H</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">Z = H^{-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"vPLiZOvC7j"},{"type":"text","value":" specifically those where ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"WBDeRCwgla"},{"type":"inlineMath","value":"A","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"LTwIDcDeAr"},{"type":"text","value":" is non-zero. Since ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"pdCRZG7Lho"},{"type":"inlineMath","value":"A","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"aX0mSgPYI5"},{"type":"text","value":" is banded, we only need the elements of ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"vh2DyUuzBe"},{"type":"inlineMath","value":"Z","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span>","key":"e0j6GVxsAo"},{"type":"text","value":" within the bandwidth of ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"eNR1cfwuAR"},{"type":"inlineMath","value":"A","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"TvH0KxSZXG"},{"type":"text","value":".","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"OF5CjQX2aa"}],"key":"KsjUbt3RKR"},{"type":"paragraph","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"strong","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Takahashi’s Equations","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"NKCIBhZ6nl"}],"key":"q8EnEJZGxv"},{"type":"text","value":" provide a way to compute the elements of ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"dztK6gDxPj"},{"type":"inlineMath","value":"Z","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span>","key":"YHTf3Lhzsm"},{"type":"text","value":" within the band of ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"DXIKVQzcS6"},{"type":"inlineMath","value":"H","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span>","key":"LgDKgFybYo"},{"type":"text","value":" (which includes the band of ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"Jwygj3NgED"},{"type":"inlineMath","value":"A","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"aHkUGKHRO3"},{"type":"text","value":") using a backward recurrence starting from the bottom-right corner.","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"kHXX7pu26O"}],"key":"OJKDf9HqCF"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":134,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute ","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"mA30vCN4Qy"},{"type":"inlineMath","value":"Z_{NN} = 1 / U_{NN}^2","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mrow><mi>N</mi><mi>N</mi></mrow></msub><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><msubsup><mi>U</mi><mrow><mi>N</mi><mi>N</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">Z_{NN} = 1 / U_{NN}^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">NN</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0894em;vertical-align:-0.2753em;\"></span><span class=\"mord\">1/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4247em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">NN</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2753em;\"><span></span></span></span></span></span></span></span></span></span>","key":"v0Sgga5VS9"},{"type":"text","value":".","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"A4bJi8URmy"}],"key":"HKMGGOiAog"}],"key":"jpsU6xHDbH"},{"type":"listItem","spread":true,"position":{"start":{"line":135,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Iterate backwards from ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"FuhtwJBmhS"},{"type":"inlineMath","value":"i = N-1","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mi>N</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">i = N-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"USqNygwzQl"},{"type":"text","value":" to ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"ykppc4miJl"},{"type":"text","value":"1","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"ICOY20lxh7"},{"type":"text","value":":","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"J8mbtf6wVD"}],"key":"uz8cugSEXD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":136,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute off-diagonal elements ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"E1lNSzO4au"},{"type":"inlineMath","value":"Z_{ij}","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Z_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"SgWFDeLUCs"},{"type":"text","value":" inside the band using previously computed ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"ggvSeiKODU"},{"type":"inlineMath","value":"Z","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span>","key":"zZ7YBlTSmG"},{"type":"text","value":" values and ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"kPZVyq0frF"},{"type":"inlineMath","value":"U","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span></span>","key":"mnWiLrXgoZ"},{"type":"text","value":".","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"wky7SJ7MCK"}],"key":"APQRlEuu9p"}],"key":"Tme3igThIn"},{"type":"listItem","spread":true,"position":{"start":{"line":137,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute diagonal element ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"N8clyQpTiM"},{"type":"inlineMath","value":"Z_{ii}","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">Z_{ii}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ii</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"OcNl0pa5lj"},{"type":"text","value":".","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"dYmksDQmaF"}],"key":"l4TWfwq4Cz"}],"key":"uapPpdKNHd"}],"key":"xstf8RG4Mo"}],"key":"OPk5gje9FT"}],"key":"curYw5Gyx8"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"Once we have the band of ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"KNQ5TZpGtB"},{"type":"inlineMath","value":"Z","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span>","key":"xEWNqYPiXb"},{"type":"text","value":", we can compute the trace of the product ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"jjPJSLpLgQ"},{"type":"inlineMath","value":"Z A","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Z</mi><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">Z A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"rOKJsoG7wZ"},{"type":"text","value":" efficiently:","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"sn4sumf5Gu"}],"key":"sXeEHFGQog"},{"type":"math","value":"\\text{trace}(Z A) = \\sum_{i,j} Z_{ij} A_{ji}","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>trace</mtext><mo stretchy=\"false\">(</mo><mi>Z</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></munder><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>A</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\text{trace}(Z A) = \\sum_{i,j} Z_{ij} A_{ji}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">trace</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4638em;vertical-align:-1.4138em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ji</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"9","key":"x5wqfvOdp4"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"Since ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"fRsYPl4WRJ"},{"type":"inlineMath","value":"A","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"sJTPj7LNHt"},{"type":"text","value":" is symmetric and banded, the sum only involves indices ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"SC3hwstPYc"},{"type":"inlineMath","value":"(i,j)","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(i,j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span></span></span></span>","key":"A6nfl6ORB6"},{"type":"text","value":" where ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"R3UGEwGp77"},{"type":"inlineMath","value":"|i-j| \\le \\text{bandwidth}","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>i</mi><mo>−</mo><mi>j</mi><mi mathvariant=\"normal\">∣</mi><mo>≤</mo><mtext>bandwidth</mtext></mrow><annotation encoding=\"application/x-tex\">|i-j| \\le \\text{bandwidth}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">bandwidth</span></span></span></span></span>","key":"ZzKbif8LlV"},{"type":"text","value":", which are exactly the elements we computed.","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"e0X0rtRhMP"}],"key":"SX6ztpHlOV"},{"type":"heading","depth":3,"position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"Handling Natural Boundary Conditions (The Projection Matrix ","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"TWiXkbfe0z"},{"type":"inlineMath","value":"P","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"BEgFPWLTQ9"},{"type":"text","value":")","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"Wv6P2iKmEb"}],"identifier":"handling-natural-boundary-conditions-the-projection-matrix-p","label":"Handling Natural Boundary Conditions (The Projection Matrix P)","html_id":"handling-natural-boundary-conditions-the-projection-matrix-p","implicit":true,"key":"wDh7Mr9xVZ"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"The “natural” boundary conditions (zero second derivative at endpoints) imply linear constraints on the B-spline coefficients ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"qjmh1zD9TF"},{"type":"inlineMath","value":"\\theta","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span>","key":"NtR7QPXCuL"},{"type":"text","value":".","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"HoxZFDYuPG"}],"key":"dqZUD2bTuS"},{"type":"math","value":"\\theta_0 = w_{s1} \\theta_1 + w_{s2} \\theta_2","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>θ</mi><mn>0</mn></msub><mo>=</mo><msub><mi>w</mi><mrow><mi>s</mi><mn>1</mn></mrow></msub><msub><mi>θ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mrow><mi>s</mi><mn>2</mn></mrow></msub><msub><mi>θ</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\theta_0 = w_{s1} \\theta_1 + w_{s2} \\theta_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"10","key":"xAt8nX0NUm"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"T3WcJqxrq1"}],"key":"ZZvtIjiDSa"},{"type":"math","value":"\\theta_{N-1} = w_{e1} \\theta_{N-2} + w_{e2} \\theta_{N-3}","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>θ</mi><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>w</mi><mrow><mi>e</mi><mn>1</mn></mrow></msub><msub><mi>θ</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>w</mi><mrow><mi>e</mi><mn>2</mn></mrow></msub><msub><mi>θ</mi><mrow><mi>N</mi><mo>−</mo><mn>3</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\theta_{N-1} = w_{e1} \\theta_{N-2} + w_{e2} \\theta_{N-3}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9028em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9028em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9028em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"11","key":"S5ImjvSvYR"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"These constraints reduce the number of free parameters from ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"Liy9y4nlsN"},{"type":"inlineMath","value":"N","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"KibcJwmjSJ"},{"type":"text","value":" to ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"TVq8LBhDog"},{"type":"inlineMath","value":"N-2","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">N-2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"gWmXYl0GnH"},{"type":"text","value":".\nWe can express the full parameter vector ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"yCUloJtySq"},{"type":"inlineMath","value":"\\theta","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span>","key":"R3jKbT5Pox"},{"type":"text","value":" as a linear transformation of the reduced parameters ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"AMzNO4Rxmg"},{"type":"inlineMath","value":"\\gamma = (\\theta_1, \\dots, \\theta_{N-2})^T","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>γ</mi><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>θ</mi><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\gamma = (\\theta_1, \\dots, \\theta_{N-2})^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"rUoGnF1ETh"},{"type":"text","value":":","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"YmYcx2BDQd"}],"key":"gF2B7xIlYm"},{"type":"math","value":"\\theta = P \\gamma","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>θ</mi><mo>=</mo><mi>P</mi><mi>γ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta = P \\gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span></span>","enumerator":"12","key":"ryD1dGrlvm"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"KW7N11PX0R"},{"type":"inlineMath","value":"P","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"lTyJIIzFbg"},{"type":"text","value":" is an ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"dfcXTIsXG2"},{"type":"inlineMath","value":"N \\times (N-2)","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>×</mo><mo stretchy=\"false\">(</mo><mi>N</mi><mo>−</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">N \\times (N-2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span>","key":"VRuejf3MSz"},{"type":"text","value":" sparse projection matrix. ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"wtOruCqEMe"},{"type":"inlineMath","value":"P","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"msFTuB1rAY"},{"type":"text","value":" is mostly an identity matrix (shifted), with the first row and last row having non-zero entries in the first two and last two columns respectively.","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"K15KkELvS9"}],"key":"fp8ccLnBWu"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"The optimization problem in terms of ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"zO3cdCSwzZ"},{"type":"inlineMath","value":"\\gamma","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>γ</mi></mrow><annotation encoding=\"application/x-tex\">\\gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span>","key":"Yp2EPch7Fv"},{"type":"text","value":" becomes:","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"gnesQcaVwl"}],"key":"HBd40jvbYZ"},{"type":"math","value":"\\min_{\\gamma} (y - N P \\gamma)^T W (y - N P \\gamma) + \\lambda \\gamma^T P^T \\Omega_N P \\gamma","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>γ</mi></munder><mo stretchy=\"false\">(</mo><mi>y</mi><mo>−</mo><mi>N</mi><mi>P</mi><mi>γ</mi><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mi>W</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>−</mo><mi>N</mi><mi>P</mi><mi>γ</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>λ</mi><msup><mi>γ</mi><mi>T</mi></msup><msup><mi>P</mi><mi>T</mi></msup><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><mi>P</mi><mi>γ</mi></mrow><annotation encoding=\"application/x-tex\">\\min_{\\gamma} (y - N P \\gamma)^T W (y - N P \\gamma) + \\lambda \\gamma^T P^T \\Omega_N P \\gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.5861em;vertical-align:-0.8361em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.4em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05556em;\">γ</span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8361em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">NP</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">NP</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0858em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span></span>","enumerator":"13","key":"KluLRrWJZT"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"The normal equations are:","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"pa6IiD0bWZ"}],"key":"sNKmIY5kJd"},{"type":"math","value":"(P^T N^T W N P + \\lambda P^T \\Omega_N P) \\gamma = P^T N^T W y","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><msup><mi>P</mi><mi>T</mi></msup><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>N</mi><mi>P</mi><mo>+</mo><mi>λ</mi><msup><mi>P</mi><mi>T</mi></msup><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><mi>P</mi><mo stretchy=\"false\">)</mo><mi>γ</mi><mo>=</mo><msup><mi>P</mi><mi>T</mi></msup><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">(P^T N^T W N P + \\lambda P^T \\Omega_N P) \\gamma = P^T N^T W y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">NP</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0858em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>","enumerator":"14","key":"GlpzpwcpqU"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"QNYoleFbDJ"},{"type":"inlineMath","value":"\\tilde{A} = P^T N^T W N P","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>A</mi><mo>~</mo></mover><mo>=</mo><msup><mi>P</mi><mi>T</mi></msup><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>N</mi><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">\\tilde{A} = P^T N^T W N P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9202em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9202em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">A</span></span><span style=\"top:-3.6023em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1111em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">NP</span></span></span></span>","key":"WoDNrmDiMO"},{"type":"text","value":" and ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"iVC1C8JbwL"},{"type":"inlineMath","value":"\\tilde{\\Omega} = P^T \\Omega_N P","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"normal\">Ω</mi><mo>~</mo></mover><mo>=</mo><msup><mi>P</mi><mi>T</mi></msup><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">\\tilde{\\Omega} = P^T \\Omega_N P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9202em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9202em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\">Ω</span></span><span style=\"top:-3.6023em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9913em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"w8ScrHvdB3"},{"type":"text","value":". These matrices remain banded (with slightly modified corners).\nWe solve for ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"sd6Jrl8t7h"},{"type":"inlineMath","value":"\\gamma","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>γ</mi></mrow><annotation encoding=\"application/x-tex\">\\gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span>","key":"aSZZwdLo3x"},{"type":"text","value":" and then reconstruct ","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"mKltKfmjT7"},{"type":"inlineMath","value":"\\theta = P \\gamma","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>=</mo><mi>P</mi><mi>γ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta = P \\gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span>","key":"RAKCWlfGyP"},{"type":"text","value":".","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"uxRB9V1JyI"}],"key":"rXcFJn5aMM"},{"type":"paragraph","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"Our ","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"WuOesmPn4B"},{"type":"inlineCode","value":"bspline","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"ph9p5HkxNO"},{"type":"text","value":" engine implements this by:","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"n6SFU4aY8b"}],"key":"ci7NTZoOM3"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":173,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Constructing the full banded matrices ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"HAd4sq0YwA"},{"type":"inlineMath","value":"N^T W N","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>N</mi><mi>T</mi></msup><mi>W</mi><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N^T W N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"SygS59hi3L"},{"type":"text","value":" and ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"KaX1C3W9AO"},{"type":"inlineMath","value":"\\Omega_N","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\Omega_N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"B1rsca5Wwl"},{"type":"text","value":".","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"xezE71qvLq"}],"key":"if2lQtsyWG"}],"key":"PoGH0LBHnt"},{"type":"listItem","spread":true,"position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Applying the projection ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"jw9jbaB50C"},{"type":"inlineMath","value":"P","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"XSkmyOuUrF"},{"type":"text","value":" in-place to the bands (modifying the top-left and bottom-right blocks).","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"u9LLXbUAxK"}],"key":"sOVCeRjjKo"}],"key":"sJLbyQs26d"},{"type":"listItem","spread":true,"position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Solving the reduced banded system.","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"GidjmPUJdt"}],"key":"XJhD7eYNmw"}],"key":"kY3IrMJA0Y"},{"type":"listItem","spread":true,"position":{"start":{"line":176,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Using Takahashi’s algorithm on the reduced system to compute the degrees of freedom efficiently.","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"Y6CbO3SkKx"}],"key":"twyn5XtWzz"}],"key":"of3UzDwq27"}],"key":"jrgEPF4Zb0"},{"type":"heading","depth":2,"position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"4. Comparison with R’s ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"fMPgZrycXD"},{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"ElNPQSeVuT"}],"identifier":"id-4-comparison-with-rs-smooth-spline","label":"4. Comparison with R’s smooth.spline","html_id":"id-4-comparison-with-rs-smooth-spline","implicit":true,"key":"fvLBNSyylG"},{"type":"table","position":{"start":{"line":180,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"Feature","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"HQ9MmCYmlR"}],"key":"haxWcjTSPV"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"L6RZ6llhED"},{"type":"text","value":" (R)","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"csPYC2ZcMa"}],"key":"zEjiMSrink"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"inlineCode","value":"smoothing_spline","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"FLTIT4gstv"},{"type":"text","value":" (Python)","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"QNzXbqtW8d"}],"key":"k67euP2rWi"}],"key":"vvlgCdHWEc"},{"type":"tableRow","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"strong","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"Algorithm","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"xBnTeAOsyh"}],"key":"RuptTfH9RZ"}],"key":"ofEO2kEDeK"},{"type":"tableCell","align":"left","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"Reinsch Form (","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"ULMpUaulJr"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"mCkTW7YTkI"},{"type":"text","value":")","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"qndytSeSIW"}],"key":"ahQt9sCuja"},{"type":"tableCell","align":"left","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"inlineCode","value":"engine='auto'","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"AjLUCejUBq"},{"type":"text","value":" (selects best), ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"WqYAKstrru"},{"type":"inlineCode","value":"engine='reinsch'","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"nG19HHMLKO"},{"type":"text","value":" (","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"kM7ruSMRcO"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"CVAsSoQ22J"},{"type":"text","value":"), ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"zWRzOuObU6"},{"type":"inlineCode","value":"engine='natural'","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"xE2sMMMZPe"},{"type":"text","value":" (","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"gy0RsDrJJd"},{"type":"inlineMath","value":"O(NK^2)","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><msup><mi>K</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(NK^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"l7Q47ocWhc"},{"type":"text","value":"), ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"MdnLVOOlsC"},{"type":"inlineCode","value":"engine='bspline'","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"B0yHTkbbsU"},{"type":"text","value":" (Banded)","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"mPgwX5UIxv"}],"key":"P6idZlN10H"}],"key":"q1PEzJwKHY"},{"type":"tableRow","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"strong","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"Knots","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"Xl3pIB4IcE"}],"key":"X3MN4jA6Vs"}],"key":"xUZPRLbJxF"},{"type":"tableCell","align":"left","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"All unique ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"fXJSm46a45"},{"type":"inlineMath","value":"x","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"KUd0pjur2g"},{"type":"text","value":" (default) or ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"OQpZKm33Ot"},{"type":"inlineMath","value":"nknots","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mi>k</mi><mi>n</mi><mi>o</mi><mi>t</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">nknots</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">nkn</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"CvfPTKXCU7"}],"key":"GsNodvsuc8"},{"type":"tableCell","align":"left","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"All unique ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"Ycgv8OtSX2"},{"type":"inlineMath","value":"x","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"QerWEbZIkg"},{"type":"text","value":" or specified ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"saBHqQ2IY5"},{"type":"inlineCode","value":"n_knots","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"p28A93mPkt"}],"key":"l6MD2xqCFt"}],"key":"R4ibw8MSbY"},{"type":"tableRow","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"strong","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"text","value":"Input ","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"tMWrqjjrnP"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"zYJK7C99tr"}],"key":"Xufm0pUqEe"}],"key":"vXZkYAOwkT"},{"type":"tableCell","align":"left","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"text","value":"Via ","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"Wybso9g9Ai"},{"type":"inlineCode","value":"spar","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"X5HiOHEOZe"},{"type":"text","value":" or ","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"d0QC03YaSI"},{"type":"inlineCode","value":"lambda","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"s4TL4m1wmp"}],"key":"PaAdac0Yfl"},{"type":"tableCell","align":"left","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"text","value":"Via ","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"QPF5Fuvpps"},{"type":"inlineCode","value":"lamval","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"ffjd2bsL8U"}],"key":"e1WxAHXaCI"}],"key":"pgnXMzxAUg"},{"type":"tableRow","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"strong","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"Input ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"sKJJNk5Hi3"},{"type":"inlineMath","value":"df","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">df</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span></span></span></span>","key":"EnfG5RyDM9"}],"key":"ZTinLnCiUR"}],"key":"iFvYyRmBPH"},{"type":"tableCell","align":"left","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"Supported","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"RZmxWBEbnx"}],"key":"sBl8ISe9gi"},{"type":"tableCell","align":"left","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"Supported (via root finding)","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"pcpMZ7lrGc"}],"key":"ax2rC1YVwh"}],"key":"f1YYEXc8Od"},{"type":"tableRow","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"strong","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"Automatic Tuning","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"UJIy5ptho9"}],"key":"eaOcr5xZFx"}],"key":"HdlNpzHyhj"},{"type":"tableCell","align":"left","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"GCV / CV","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"XVBQ39REHI"}],"key":"VbnamCnWoR"},{"type":"tableCell","align":"left","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"GCV","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"IsSHFbAfGg"}],"key":"nq8QfzfJ9z"}],"key":"Vl2F3uToed"},{"type":"tableRow","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"strong","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Weights","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"TWiMPmV7nW"}],"key":"exZAeE8okx"}],"key":"lWflERSuXS"},{"type":"tableCell","align":"left","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Supported","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"NK6hmUYrbd"}],"key":"qoQc5Kt7Wm"},{"type":"tableCell","align":"left","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Supported","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"aXBCLzyAIf"}],"key":"uda3FbB0tR"}],"key":"DJfvDsAaWG"},{"type":"tableRow","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"strong","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"Derivatives","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"b2M2ohQldW"}],"key":"NufMIBz8TQ"}],"key":"OzlRiCYgAk"},{"type":"tableCell","align":"left","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"Built-in","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"rWBlqOZy9k"}],"key":"BWMHntEUYS"},{"type":"tableCell","align":"left","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"Exposed via ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"ck4Lzrx6pn"},{"type":"inlineCode","value":"predict(deriv=...)","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"FwukbW2eQF"}],"key":"GVkucG6sCk"}],"key":"F7f1sayzD9"},{"type":"tableRow","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"strong","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"Extrapolation","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"WBr4b3gjgn"}],"key":"ysPxXwFVwR"}],"key":"JsZlcA2Gs8"},{"type":"tableCell","align":"left","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"Linear (via ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"sMVRi7WZhP"},{"type":"inlineCode","value":"predict","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"BxYXbilApo"},{"type":"text","value":")","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"U77KnVf1fb"}],"key":"blylsrw1Wj"},{"type":"tableCell","align":"left","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"Linear (explicitly handled)","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"e2MpZEeOiP"}],"key":"ihjppxM6H6"}],"key":"dJL13Z04jT"}],"key":"oRkbEbiRG7"},{"type":"heading","depth":3,"position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"children":[{"type":"text","value":"Key Differences","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"BnIzwDPF5P"}],"identifier":"key-differences","label":"Key Differences","html_id":"key-differences","implicit":true,"key":"xXVrVDfnAn"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":192,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":192,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"Speed:","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"HXZLptPZa7"}],"key":"yGn4sFVioR"},{"type":"text","value":" For ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"oGKjf70Iu3"},{"type":"inlineMath","value":"N=10,000","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><mn>10</mn><mo separator=\"true\">,</mo><mn>000</mn></mrow><annotation encoding=\"application/x-tex\">N=10,000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">10</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">000</span></span></span></span>","key":"gVzeqETv6J"},{"type":"text","value":", ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"bOS2gHMEPM"},{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"iV59VEGzB8"},{"type":"text","value":" is faster because it exploits the band structure of the full system. Our implementation allows ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"RZW26xHvck"},{"type":"inlineCode","value":"n_knots < N","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"a1oYFDIwAF"},{"type":"text","value":" (Regression Splines), which restores speed (","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"nKqxVmAOWb"},{"type":"inlineMath","value":"O(N K^2)","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><msup><mi>K</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N K^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"sDvlt7VCca"},{"type":"text","value":") and reduces overfitting risk, a feature ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"JyJmCYaYmu"},{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"m0kV8e5lUb"},{"type":"text","value":" supports via ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"H7tXbePZCw"},{"type":"inlineCode","value":"nknots","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"BCqW1MXRu8"},{"type":"text","value":".","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"eRqdCEs5vq"}],"key":"kimIoSsXUZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":193,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"engine='reinsch'","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"I35v2QrUHQ"},{"type":"text","value":": Fast ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"DoQqd0bheh"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"JjEZ8TyxeZ"},{"type":"text","value":" implementation for when knots = unique ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"pLfbpyqprk"},{"type":"inlineMath","value":"x","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"MuEzaUX5vA"},{"type":"text","value":". Matches ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"HSwdJ8NacT"},{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"FWAjwH2u4M"},{"type":"text","value":" performance.","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"h6VR8Pr4KA"}],"key":"eEwuBfKCBX"}],"key":"sCLAktcy9k"},{"type":"listItem","spread":true,"position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"engine='natural'","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"ZLUyfXrwtZ"},{"type":"text","value":": Uses the natural cubic spline basis. Good for general use and when ","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"sunuYuBvzi"},{"type":"inlineMath","value":"K < N","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>&lt;</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">K &lt; N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"YSIPz1jyYl"},{"type":"text","value":".","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"tCfgmTFyHz"}],"key":"YPoOa2M1Qo"}],"key":"sWQj6jGwoe"},{"type":"listItem","spread":true,"position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"engine='bspline'","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"G1D3AdrSFd"},{"type":"text","value":": Uses B-spline basis. Efficient and stable, good for sparse matrices.","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"wEWF3lYXBg"}],"key":"A9Qru2upGL"}],"key":"qiBGA2Bg6E"}],"key":"e4mcsfGjX4"}],"key":"C2E74F4cEG"},{"type":"listItem","spread":true,"position":{"start":{"line":196,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"Spar (R specific):","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"xz1EAelNGd"}],"key":"SBKhv1uweh"},{"type":"text","value":" R uses a scaling parameter ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"jjEa1FZlV2"},{"type":"inlineCode","value":"spar","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"toi7scYdwl"},{"type":"text","value":" related to ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"D9SYHBlpLd"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"zrKE2ZdqMf"},{"type":"text","value":". We use raw ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"KJv7k8jZAd"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"EhOJvoKimx"},{"type":"text","value":" (scaled by ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"KGvBQ9ClH1"},{"type":"inlineMath","value":"x","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"NdYYFGIrHa"},{"type":"text","value":"-range cubed for numerical stability).","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"OW81NWTEhm"}],"key":"zQX5zHR7Os"}],"key":"RGJIzixXwn"}],"key":"tRZ9bc0UqB"},{"type":"heading","depth":2,"position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"5. References","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"PcgCnLlQ0Z"}],"identifier":"id-5-references","label":"5. References","html_id":"id-5-references","implicit":true,"key":"a1Tnim6qk6"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":200,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Hastie, T., Tibshirani, R., & Friedman, J. (2009). ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"vGcElzt2s9"},{"type":"emphasis","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"The Elements of Statistical Learning: Data Mining, Inference, and Prediction","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"DEaVenZsVA"}],"key":"fNDxlSHFqU"},{"type":"text","value":". 2nd Edition. Springer. (Chapter 5).","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"KXLGw6Sxt1"}],"key":"na4vrJFlnY"}],"key":"sgCuDNiofw"},{"type":"listItem","spread":true,"position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Green, P. J., & Silverman, B. W. (1994). ","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"q1YFa32Rgi"},{"type":"emphasis","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"text","value":"Nonparametric Regression and Generalized Linear Models: A Roughness Penalty Approach","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"UGlRBWzKwg"}],"key":"gbHVnxtidQ"},{"type":"text","value":". Chapman and Hall/CRC.","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"rGvJqVyP64"}],"key":"FT0X9TCk9j"}],"key":"X1A5Uo4rOb"}],"key":"unJCsfAcQ1"}],"key":"w8NZa410Xb"}],"key":"PeNKPKWEVk"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Smoothing Spline","url":"/","group":"Smoothing Spline"},"next":{"title":"Comparing smoothing_spline with R’s smooth.spline","url":"/compare-r","group":"Smoothing Spline"}}},"domain":"http://localhost:3000"}