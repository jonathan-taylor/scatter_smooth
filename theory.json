{"version":3,"kind":"Article","sha256":"b2a0344a198d01ca34c50ddf31a385e0f2a6175918515d27b23e6d762b67aa9d","slug":"theory","location":"/theory.md","dependencies":[],"frontmatter":{"title":"Smoothing Splines: Theory and Implementation","content_includes_title":false,"authors":[{"nameParsed":{"literal":"Jonathan Taylor","given":"Jonathan","family":"Taylor"},"name":"Jonathan Taylor","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/executablebooks/jupyter-book","source_url":"https://github.com/executablebooks/jupyter-book/blob/main/docs/theory.md","edit_url":"https://github.com/executablebooks/jupyter-book/edit/main/docs/theory.md","exports":[{"format":"md","filename":"theory.md","url":"/build/theory-2d2e6abae148b0df91dfdefb5bfe7223.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This document outlines the theoretical background for the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AntpqTZHgP"},{"type":"inlineCode","value":"smoothing_spline","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PV2r7bhzub"},{"type":"text","value":" package, synthesizing concepts from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GEBdQzKRec"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Elements of Statistical Learning","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Jyxcnl6c34"}],"key":"JineL3yZNe"},{"type":"text","value":" (Hastie, Tibshirani, Friedman), specifically Chapter 5. It also discusses the implementation details (Reinsch form vs. Basis form) and compares the features with R’s ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Tdc17xZ0R0"},{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QrrRbldOVo"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wdkdpKW0j8"}],"key":"KxPIet06Lb"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"1. The Smoothing Spline Problem","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bBReOBXx0c"}],"identifier":"id-1-the-smoothing-spline-problem","label":"1. The Smoothing Spline Problem","html_id":"id-1-the-smoothing-spline-problem","implicit":true,"key":"YqQDtaEdPN"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The goal of smoothing splines is to find a function ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KbvZPuyRxk"},{"type":"inlineMath","value":"f(x)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"x8gPxjeXL3"},{"type":"text","value":" that fits the data ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"O6p7Juk4cu"},{"type":"inlineMath","value":"\\{(x_i, y_i)\\}_{i=1}^N","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><msubsup><mo stretchy=\"false\">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\{(x_i, y_i)\\}_{i=1}^N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1em;vertical-align:-0.2587em;\"></span><span class=\"mopen\">{(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">}</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ngoh2JA4bV"},{"type":"text","value":" well while remaining smooth. This is formulated as the minimization of a penalized residual sum of squares:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eNUEtuLTqB"}],"key":"UtLS82UR9J"},{"type":"math","value":"\\min_{f} \\sum_{i=1}^N (y_i - f(x_i))^2 + \\lambda \\int [f''(t)]^2 dt","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>f</mi></munder><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><mo>∫</mo><mo stretchy=\"false\">[</mo><msup><mi>f</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup><mi>d</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">\\min_{f} \\sum_{i=1}^N (y_i - f(x_i))^2 + \\lambda \\int [f&#x27;&#x27;(t)]^2 dt</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.3479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8882em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2222em;vertical-align:-0.8622em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span></span></span></span></span>","enumerator":"1","key":"JRa0mTbjqX"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KILF7NocIb"},{"type":"inlineMath","value":"\\lambda \\ge 0","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda \\ge 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"uCDrPo5vsQ"},{"type":"text","value":" is a smoothing parameter.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"P7W1kReYqj"}],"key":"RzBnGu8SMq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\lambda = 0","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"aOQ1wl7YZb"},{"type":"text","value":": ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Xq1sfpZ6wX"},{"type":"inlineMath","value":"f","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"KDDMY4dlPD"},{"type":"text","value":" becomes an interpolating spline (passes through every point).","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"kbuTO2wA5B"}],"key":"GcdtA2ERb8"}],"key":"Dk8GL08U5D"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\lambda \\to \\infty","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda \\to \\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"vufeC83rR5"},{"type":"text","value":": ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"EacCi5igkh"},{"type":"inlineMath","value":"f","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"i66Lev6kx7"},{"type":"text","value":" approaches the linear least squares fit.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"qRwgsRrlzN"}],"key":"GMS2TFLsiw"}],"key":"tPwfnwX4Ds"}],"key":"hQYvhVGITn"},{"type":"heading","depth":3,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"The Solution: Natural Cubic Spline","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"YoEV2Oz0zM"}],"identifier":"the-solution-natural-cubic-spline","label":"The Solution: Natural Cubic Spline","html_id":"the-solution-natural-cubic-spline","implicit":true,"key":"sb5C56vGy3"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Remarkably, the solution to this infinite-dimensional optimization problem is a finite-dimensional ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"GCibCqPdl0"},{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Natural Cubic Spline","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"QXY4AOEnrA"}],"key":"OeHiLEIPow"},{"type":"text","value":" with knots at the unique values of ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ffBoFbOIlv"},{"type":"inlineMath","value":"x_i","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"JezCdRiolg"},{"type":"text","value":".","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"LzaKLej16w"}],"key":"x08h619UUT"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"A natural cubic spline is a piecewise cubic polynomial that is continuous up to its second derivative, and linear beyond the boundary knots (i.e., its second derivative is zero at the boundaries).","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"tcWxiGfmCv"}],"key":"di0ZyTwGOy"},{"type":"heading","depth":2,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"2. Matrix Formulation","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"SfKUz7aLMW"}],"identifier":"id-2-matrix-formulation","label":"2. Matrix Formulation","html_id":"id-2-matrix-formulation","implicit":true,"key":"Kw2pNiPpNy"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Since the solution is a linear combination of basis functions, we can write:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"SZBpndeaiz"}],"key":"nBM8RRTeC5"},{"type":"math","value":"f(x) = \\sum_{j=1}^N \\theta_j N_j(x)","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>θ</mi><mi>j</mi></msub><msub><mi>N</mi><mi>j</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x) = \\sum_{j=1}^N \\theta_j N_j(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.2421em;vertical-align:-1.4138em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"2","key":"mSJ6jTjtFL"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"jVDM7OFarC"},{"type":"inlineMath","value":"N_j(x)","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>j</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">N_j(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"I3AnUd4Bfl"},{"type":"text","value":" are the natural cubic spline basis functions.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"EEy5qlGgtm"}],"key":"Gl2q9uiCkl"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"The optimization problem reduces to:","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"DpA62BJ5fe"}],"key":"a0iG5xfQ3x"},{"type":"math","value":"\\min_{ \\theta} (y - N \\theta)^T (y - N \\theta) + \\lambda \\theta^T \\Omega_N \\theta","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>θ</mi></munder><mo stretchy=\"false\">(</mo><mi>y</mi><mo>−</mo><mi>N</mi><mi>θ</mi><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mo stretchy=\"false\">(</mo><mi>y</mi><mo>−</mo><mi>N</mi><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>λ</mi><msup><mi>θ</mi><mi>T</mi></msup><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\min_{ \\theta} (y - N \\theta)^T (y - N \\theta) + \\lambda \\theta^T \\Omega_N \\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.5021em;vertical-align:-0.7521em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.3479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ</span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7521em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Nθ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">Nθ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0413em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span>","enumerator":"3","key":"bf3AlWepVd"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"where:","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"OiBx3Er2hz"}],"key":"Ypaw6t0VlK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":37,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"N_{ij} = N_j(x_i)","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>N</mi><mi>j</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">N_{ij} = N_j(x_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"oHpwsDFJK7"},{"type":"text","value":" is the basis matrix.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"Q3JjCoohZh"}],"key":"Vz9ZRiU34Z"}],"key":"bREjfufUm0"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"(\\Omega_N)_{jk} = \\int N_j''(t) N_k''(t) dt","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><msub><mo stretchy=\"false\">)</mo><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><mo>∫</mo><msubsup><mi>N</mi><mi>j</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msubsup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><msubsup><mi>N</mi><mi>k</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msubsup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mi>d</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">(\\Omega_N)_{jk} = \\int N_j&#x27;&#x27;(t) N_k&#x27;&#x27;(t) dt</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">jk</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1998em;vertical-align:-0.3948em;\"></span><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4413em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3948em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-2.4169em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2831em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"kXxam2gBbl"},{"type":"text","value":" is the penalty matrix.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"iTg01FzTNn"}],"key":"PSHOZkt0Lv"}],"key":"tj3L58If5z"}],"key":"npIoKsX9ya"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"The solution is a generalized ridge regression:","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"FkM9RgOQn5"}],"key":"CAd0Dw9D4o"},{"type":"math","value":"\\hat{\theta} = (N^T N + \\lambda \\Omega_N)^{-1} N^T y","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mrow><mi>h</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow><mo>^</mo></mover><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mi>T</mi></msup><mi>N</mi><mo>+</mo><mi>λ</mi><msub><mi mathvariant=\"normal\">Ω</mi><mi>N</mi></msub><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>N</mi><mi>T</mi></msup><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\\hat{\theta} = (N^T N + \\lambda \\Omega_N)^{-1} N^T y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9579em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord\">Ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>","enumerator":"4","key":"POhOAZkLB1"},{"type":"heading","depth":3,"position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"Reinsch Form vs. Basis Form","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"fM789Htgc2"}],"identifier":"reinsch-form-vs-basis-form","label":"Reinsch Form vs. Basis Form","html_id":"reinsch-form-vs-basis-form","implicit":true,"key":"KmAosXzVGL"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"There are two primary ways to compute the solution.","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"XH1dXLvLrf"}],"key":"MBDE660jxZ"},{"type":"heading","depth":4,"position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"A. The Basis Form (Used in this Package and for ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"RVpbHyD5lZ"},{"type":"inlineMath","value":"K=N","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">K=N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"LpHKcqGwXw"},{"type":"text","value":")","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"Ba4Udv3Smy"}],"identifier":"a-the-basis-form-used-in-this-package-and-for-k-n","label":"A. The Basis Form (Used in this Package and for K=N)","html_id":"a-the-basis-form-used-in-this-package-and-for-k-n","implicit":true,"key":"xlREt0zK9w"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"We explicitly construct the basis matrix ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"phrvefXPiB"},{"type":"inlineMath","value":"N","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"Ww3sQQSNpP"},{"type":"text","value":" and the penalty matrix ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"BGR3BWHaa8"},{"type":"inlineMath","value":"\\Omega","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Ω</mi></mrow><annotation encoding=\"application/x-tex\">\\Omega</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Ω</span></span></span></span>","key":"ET4m0gPIX2"},{"type":"text","value":".","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"O9rITuxSbk"}],"key":"Dr472GVt9g"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":51,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We use the property that a natural cubic spline is determined by its values and second derivatives at the knots.","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"GQtgm2qQmX"}],"key":"DnKUVETE0R"}],"key":"s23f7DTXdB"},{"type":"listItem","spread":true,"position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Our C++ implementation constructs ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"t7vYdAltHF"},{"type":"inlineMath","value":"N","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"eMq45X3Yqo"},{"type":"text","value":" efficiently by solving the tridiagonal system that relates second derivatives to values.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"CkK6c00YEO"}],"key":"Na8lyDvCD3"}],"key":"m8A2nbh6TG"},{"type":"listItem","spread":true,"position":{"start":{"line":53,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We then solve the dense linear system ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"wm75Blyuye"},{"type":"inlineMath","value":"(N^T N + \\lambda \\Omega)\\theta = N^T y","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mi>T</mi></msup><mi>N</mi><mo>+</mo><mi>λ</mi><mi mathvariant=\"normal\">Ω</mi><mo stretchy=\"false\">)</mo><mi>θ</mi><mo>=</mo><msup><mi>N</mi><mi>T</mi></msup><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">(N^T N + \\lambda \\Omega)\\theta = N^T y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\">Ω</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0358em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"Qs3sWeoFh2"},{"type":"text","value":".","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"MliQdrbgH8"}],"key":"I3I1RUWBhs"}],"key":"ueC3xwm87h"}],"key":"p4oQcIAjno"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"strong","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Why Basis Form?","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"dzwwuphvnd"}],"key":"LBfbCPISjs"}],"key":"Qa0CSF8NSq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":56,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Allows for ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"a4hpbByWKn"},{"type":"strong","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Regression Splines","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"OtRBaps9lm"}],"key":"EePGeKaQps"},{"type":"text","value":": We can choose fewer knots than data points (","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"HnENtwfNI5"},{"type":"inlineMath","value":"K < N","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>&lt;</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">K &lt; N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"Gb028iAfdL"},{"type":"text","value":"). The math remains identical, but the matrices are smaller (","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"M08SHgTT0I"},{"type":"inlineMath","value":"K \t\\times K","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>×</mo><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K \t\\times K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>","key":"LvZYhgaLcl"},{"type":"text","value":" instead of ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"Z6J8o5kvLM"},{"type":"inlineMath","value":"N \\times N","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N \\times N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"hR6MqvLhka"},{"type":"text","value":").","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"foiVpmSumC"}],"key":"FLxvsOtSZx"}],"key":"ariJar5eVe"},{"type":"listItem","spread":true,"position":{"start":{"line":57,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Easier to extend to weighted least squares or other loss functions.","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"ycP4AcBBff"}],"key":"bYNU7GuTIB"}],"key":"RWSVZnnHQJ"}],"key":"h8iUbjMUbL"},{"type":"heading","depth":4,"position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"B. The Reinsch Form (Used in R’s ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"wWmrwlgC3a"},{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"MYisxWE4f3"},{"type":"text","value":")","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"zgP21jgiw8"}],"identifier":"b-the-reinsch-form-used-in-rs-smooth-spline","label":"B. The Reinsch Form (Used in R’s smooth.spline)","html_id":"b-the-reinsch-form-used-in-rs-smooth-spline","implicit":true,"key":"TJYw6xwc5B"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"If knots are placed at every data point (","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"RS4NHO3Bwi"},{"type":"inlineMath","value":"K=N","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">K=N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"e6Ivhu0brT"},{"type":"text","value":"), the solution vector ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"Q0DgRNgTam"},{"type":"inlineMath","value":"\\mathbf{f} = (f(x_1), \\dots, f(x_N))^T","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>N</mi></msub><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f} = (f(x_1), \\dots, f(x_N))^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"I1SrUsAcAw"},{"type":"text","value":" can be found directly without forming ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"WpHdXZLy0O"},{"type":"inlineMath","value":"N","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"Fqkx75AUj4"},{"type":"text","value":".","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"CBdsAdvwxt"}],"key":"uzuMJMcD2d"},{"type":"math","value":"\\hat{\\mathbf{f}} = (I + \\lambda K)^{-1} y","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">f</mi><mo>^</mo></mover><mo>=</mo><mo stretchy=\"false\">(</mo><mi>I</mi><mo>+</mo><mi>λ</mi><mi>K</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{f}} = (I + \\lambda K)^{-1} y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9579em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0833em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>","enumerator":"5","key":"GciqcdXHqc"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"AyNm6DijJO"},{"type":"inlineMath","value":"K = Q R^{-1} Q^T","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo><mi>Q</mi><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>Q</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">K = Q R^{-1} Q^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0358em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"iDom06A6jA"},{"type":"text","value":".","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"BVn2w4JicI"}],"key":"jZD3iJbLWD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":65,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"Q","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span>","key":"WKmbP5ZOCs"},{"type":"text","value":" is an ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"EKHKvumoA9"},{"type":"inlineMath","value":"N \\times (N-2)","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>×</mo><mo stretchy=\"false\">(</mo><mi>N</mi><mo>−</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">N \\times (N-2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span>","key":"pqXGp7hq5j"},{"type":"text","value":" tridiagonal matrix of second differences.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"PDNIfyMQC7"}],"key":"HTZSFMNkEq"}],"key":"qaQ50lKdF0"},{"type":"listItem","spread":true,"position":{"start":{"line":66,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"R","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>","key":"txT8mNQGhM"},{"type":"text","value":" is an ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"zP55UPVs2e"},{"type":"inlineMath","value":"(N-2) \\times (N-2)","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>N</mi><mo>−</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mo stretchy=\"false\">(</mo><mi>N</mi><mo>−</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(N-2) \\times (N-2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span>","key":"lEVIdb7fAQ"},{"type":"text","value":" tridiagonal matrix.","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"fxRrDOjwet"}],"key":"Tn3KuQYOw6"}],"key":"Rb9VUzv883"}],"key":"iTchrWNEfa"},{"type":"paragraph","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"These matrices can be constructed in Python as follows:","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"qgrrR2Ygca"}],"key":"Zic5HUrzKT"},{"type":"code","lang":"python","value":"import numpy as np\nfrom scipy import sparse\n\ndef get_qr_matrices(knots):\n    n_k = len(knots)\n    hk = np.diff(knots)\n    inv_hk = 1.0 / hk\n    \n    # R is a symmetric tridiagonal matrix\n    R_k = sparse.diags(\n        [hk[1:-1] / 6.0, (hk[:-1] + hk[1:]) / 3.0, hk[1:-1] / 6.0],\n        [-1, 0, 1],\n        shape=(n_k - 2, n_k - 2),\n    )\n    \n    # Q is a tridiagonal matrix with 3 diagonals\n    Q_k = sparse.diags(\n        [inv_hk[:-1], -inv_hk[:-1] - inv_hk[1:], inv_hk[1:]],\n        [0, -1, -2],\n        shape=(n_k, n_k - 2),\n    )\n    return Q_k, R_k","position":{"start":{"line":69,"column":1},"end":{"line":92,"column":1}},"key":"TS5vrc7Bvd"},{"type":"paragraph","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"This allows solving the system in ","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"lGwf21MDQo"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"HgcACRWb7s"},{"type":"text","value":" time using banded solvers, making it extremely fast for large ","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"eH4xiufwW0"},{"type":"inlineMath","value":"N","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"NBvUDxdm0J"},{"type":"text","value":".","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"xlAYHIkv4K"}],"key":"nWBwKcpJJ8"},{"type":"paragraph","position":{"start":{"line":96,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"strong","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"Our Implementation Note:","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"fH6ohgVqj2"}],"key":"rfOJn6iW0G"},{"type":"text","value":"\nWhile we use the basis form, our construction of ","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"fJyg4SJm82"},{"type":"inlineMath","value":"\\Omega","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Ω</mi></mrow><annotation encoding=\"application/x-tex\">\\Omega</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Ω</span></span></span></span>","key":"sAEGl0rMXG"},{"type":"text","value":" utilizes the exact same ","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"ahFBKBEws9"},{"type":"inlineMath","value":"Q R^{-1} Q^T","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>Q</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">Q R^{-1} Q^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0358em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"TcJExnwozA"},{"type":"text","value":" structure (computed via sparse Cholesky) to ensure mathematical equivalence to the integral penalty.","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"jkqLHx7ZEb"}],"key":"FUPmP7Y9ns"},{"type":"heading","depth":2,"position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"3. Degrees of Freedom (","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"UZvOK3L2HZ"},{"type":"inlineMath","value":"df","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">df</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span></span></span></span>","key":"GVwhL6Lygq"},{"type":"text","value":")","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"dhfF6MOz8P"}],"identifier":"id-3-degrees-of-freedom-df","label":"3. Degrees of Freedom (df)","html_id":"id-3-degrees-of-freedom-df","implicit":true,"key":"zg2MEM1WLK"},{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"The smoothing parameter ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"oZdec32Xrb"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"S2T6hWbN8A"},{"type":"text","value":" is abstract. A more intuitive measure of model complexity is the ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"EFDYqMV3xg"},{"type":"strong","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"effective degrees of freedom (","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"zGSSmXMhnI"},{"type":"inlineMath","value":"df","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">df</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span></span></span></span>","key":"cQ9mVmpT4X"},{"type":"text","value":")","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"lMlhdrTZ2P"}],"key":"f6v65UUYOz"},{"type":"text","value":".","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"tKHZxLrXDb"}],"key":"gesaVQM1Lh"},{"type":"math","value":"df(\\lambda) = \\text{trace}(\\mathbf{S}_\\lambda)","position":{"start":{"line":103,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mi>λ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mtext>trace</mtext><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">S</mi><mi>λ</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">df(\\lambda) = \\text{trace}(\\mathbf{S}_\\lambda)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">λ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">trace</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"6","key":"q49Hux3GOE"},{"type":"paragraph","position":{"start":{"line":107,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"x0N7Sk3Oxa"},{"type":"inlineMath","value":"\\mathbf{S}_\\lambda","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">S</mi><mi>λ</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{S}_\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jDgUiweuWj"},{"type":"text","value":" is the smoother matrix such that ","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"A13IdtCX89"},{"type":"inlineMath","value":"\\hat{y} = \\mathbf{S}_\\lambda y","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mo>=</mo><msub><mi mathvariant=\"bold\">S</mi><mi>λ</mi></msub><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\\hat{y} = \\mathbf{S}_\\lambda y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"h6PUZzAFnw"},{"type":"text","value":".\nIn our formulation:","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"K42xfMdpbw"}],"key":"H4DcVAjYTS"},{"type":"math","value":"\\mathbf{S}_\\lambda = N (N^T N + \\lambda \\Omega)^{-1} N^T","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"bold\">S</mi><mi>λ</mi></msub><mo>=</mo><mi>N</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mi>T</mi></msup><mi>N</mi><mo>+</mo><mi>λ</mi><mi mathvariant=\"normal\">Ω</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>N</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{S}_\\lambda = N (N^T N + \\lambda \\Omega)^{-1} N^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\">Ω</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"7","key":"KQraC4bNBy"},{"type":"paragraph","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"The relationship between ","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"nfFuIXJUkV"},{"type":"inlineMath","value":"df","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">df</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span></span></span></span>","key":"murAFIUia7"},{"type":"text","value":" and ","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"eQPhMXB6ST"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"V2EcrzchOJ"},{"type":"text","value":" is monotonic.","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"kplwuWtH54"}],"key":"wmMjbblWPp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":114,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"df \\to 2","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi><mo>→</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">df \\to 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"GPoOAKjtQO"},{"type":"text","value":" as ","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"FFeetlUWSF"},{"type":"inlineMath","value":"\\lambda \\to \\infty","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda \\to \\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"rWsHYEgIFE"},{"type":"text","value":" (Linear fit).","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"sEZ9dbQYNt"}],"key":"Tg0s1nL3NA"}],"key":"arjWUiovBo"},{"type":"listItem","spread":true,"position":{"start":{"line":115,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"df  \\to N","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi><mo>→</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">df  \\to N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"J1r95NtJ05"},{"type":"text","value":" as ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"oiE6qWLpdw"},{"type":"inlineMath","value":"\\lambda \\to 0","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda \\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"U49p2Bmznc"},{"type":"text","value":" (Interpolation).","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"OmvUOT7NhE"}],"key":"prtjDxozBC"}],"key":"oHp55NwWYP"}],"key":"ZDPv7mlipZ"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Our package allows specifying ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"A820Nuh7c6"},{"type":"inlineCode","value":"df","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"cNmlbr3o3e"},{"type":"text","value":" directly. We use a root-finding algorithm (Brent’s method) to find the unique ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"EUGoPRyCdP"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"PDHOLqLIVz"},{"type":"text","value":" that yields the requested ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"WyvXRbOUPJ"},{"type":"inlineMath","value":"df","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">df</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span></span></span></span>","key":"IVtoNVOU66"},{"type":"text","value":".","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"aMl7XR4jUy"}],"key":"UCAkqvUgZl"},{"type":"heading","depth":2,"position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"4. Comparison with R’s ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"Oj7uos4fQV"},{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"VU8F33miPL"}],"identifier":"id-4-comparison-with-rs-smooth-spline","label":"4. Comparison with R’s smooth.spline","html_id":"id-4-comparison-with-rs-smooth-spline","implicit":true,"key":"jfJYf742WU"},{"type":"table","position":{"start":{"line":121,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"Feature","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"hX8NW8DY5d"}],"key":"kvGmSk7Plu"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"TiNhtgAkrH"},{"type":"text","value":" (R)","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"zVZg7kRugH"}],"key":"pcSBsqSMeW"},{"type":"tableCell","header":true,"align":"left","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"inlineCode","value":"smoothing_spline","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"iCMIT1GIiD"},{"type":"text","value":" (Python)","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"DUzPAFCrMQ"}],"key":"df2hc7T6Xw"}],"key":"juEpgDTCzb"},{"type":"tableRow","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"strong","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Algorithm","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"edHsPe3sWG"}],"key":"nFWv4XZTRW"}],"key":"rMH7glu6pb"},{"type":"tableCell","align":"left","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Reinsch Form (","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"NDGOsVup7d"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"F4hKvCgF0H"},{"type":"text","value":")","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"DJ2fXFLr4X"}],"key":"fAiKaN6uVk"},{"type":"tableCell","align":"left","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Basis Form (","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"aEfKATI16m"},{"type":"inlineMath","value":"O(NK^2)","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><msup><mi>K</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(NK^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"KXLvjZcPFv"},{"type":"text","value":" or ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"tLTiRwVZG1"},{"type":"inlineMath","value":"O(K^3)","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>K</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(K^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"kB4xe31kjs"},{"type":"text","value":")","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"nVcwM87qUc"}],"key":"UYHfscZyCX"}],"key":"evwQ61T1Dq"},{"type":"tableRow","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"strong","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"Knots","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"uNobJvjuKv"}],"key":"c7CK27pscI"}],"key":"FnlwxO5x9H"},{"type":"tableCell","align":"left","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"All unique ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"fFHuELbALz"},{"type":"inlineMath","value":"x","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"oZji6zDM9g"},{"type":"text","value":" (default) or ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"DkoJjfNmMU"},{"type":"inlineMath","value":"nknots","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mi>k</mi><mi>n</mi><mi>o</mi><mi>t</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">nknots</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">nkn</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"mxPpdL5rcC"}],"key":"eKOjxHmwjZ"},{"type":"tableCell","align":"left","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"All unique ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"LXwN4dJufc"},{"type":"inlineMath","value":"x","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"LMP61J6Vf4"},{"type":"text","value":" or specified ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"JgPTdKbli7"},{"type":"inlineCode","value":"n_knots","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"NYDl8MPmB5"}],"key":"fWegzhvLkD"}],"key":"jitveRJc2N"},{"type":"tableRow","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"strong","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Input ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"lYWyOr3Snd"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"wT83MLRfhp"}],"key":"HBggOctZGD"}],"key":"hKyR4UNYFB"},{"type":"tableCell","align":"left","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Via ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"hQ2KyTWxI8"},{"type":"inlineCode","value":"spar","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"otOEvx02XE"},{"type":"text","value":" or ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"Kqly7DI6op"},{"type":"inlineCode","value":"lambda","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"uKdGhn5ktI"}],"key":"UGf85JeGJA"},{"type":"tableCell","align":"left","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Via ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"ZPEeV7ZiTK"},{"type":"inlineCode","value":"lamval","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"WCGyedBGmF"}],"key":"XSKvN6IDQ4"}],"key":"OMUbnJdKp6"},{"type":"tableRow","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"strong","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"Input ","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"jFcig684X7"},{"type":"inlineMath","value":"df","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">df</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">df</span></span></span></span>","key":"TA1VPus6Ox"}],"key":"G5RZBlmYQa"}],"key":"qV2YFyHFMr"},{"type":"tableCell","align":"left","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"Supported","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"Vi9e4Ki0ru"}],"key":"jGSleUPKs9"},{"type":"tableCell","align":"left","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"Supported (via root finding)","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"w6NB1QFf7K"}],"key":"evNxQwc9Rp"}],"key":"iOleK2tnK5"},{"type":"tableRow","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"strong","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Automatic Tuning","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"oqyPPE43Su"}],"key":"ej5jjDorRq"}],"key":"WNNsTSYkWv"},{"type":"tableCell","align":"left","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"GCV / CV","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"KFtjZUi1Aa"}],"key":"UOE8RG7iDN"},{"type":"tableCell","align":"left","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"GCV","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"t0QwBXje9m"}],"key":"E5daFGItrH"}],"key":"YdltE0iAIj"},{"type":"tableRow","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"strong","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"Weights","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"mBYTsDrsDt"}],"key":"vm0Sdba8Hu"}],"key":"RbSoFJK8md"},{"type":"tableCell","align":"left","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"Supported","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"sgQg6zdi7A"}],"key":"eBRmomcvtI"},{"type":"tableCell","align":"left","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"Supported","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"BpbwymdIDC"}],"key":"J3dfTIWzOK"}],"key":"jfhcQI1Wan"},{"type":"tableRow","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"strong","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Derivatives","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"rxsa5E3wdF"}],"key":"B3BQrimxwW"}],"key":"TS471GnPeQ"},{"type":"tableCell","align":"left","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Built-in","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"NwV9cGjI3H"}],"key":"YJdsZ61lST"},{"type":"tableCell","align":"left","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Exposed via ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"S1GdjuDSgl"},{"type":"inlineCode","value":"predict(deriv=...)","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"tlSLlQ1KgZ"}],"key":"us0qepawvd"}],"key":"c6nSKUMEMp"},{"type":"tableRow","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"tableCell","align":"left","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"strong","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Extrapolation","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"xyjTfS3vVF"}],"key":"i32tNdJCZc"}],"key":"lB4QPsH5vG"},{"type":"tableCell","align":"left","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Linear (via ","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"xPdmL2hgq8"},{"type":"inlineCode","value":"predict","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"WpsaFDwiBs"},{"type":"text","value":")","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"zcOJHUPyQX"}],"key":"OPIYuHx2Jq"},{"type":"tableCell","align":"left","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Linear (explicitly handled)","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"BI8AQ1pgsU"}],"key":"BeIZzZHjUu"}],"key":"bL9mE1TLAy"}],"key":"ck2VrRN4dc"},{"type":"heading","depth":3,"position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Key Differences","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"bKbCkhyIcW"}],"identifier":"key-differences","label":"Key Differences","html_id":"key-differences","implicit":true,"key":"CS1u9iI0Xb"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":133,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Speed:","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"HSUBkqrdaV"}],"key":"Y9xXy9okny"},{"type":"text","value":" For ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"phHoqcPv79"},{"type":"inlineMath","value":"N=10,000","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><mn>10</mn><mo separator=\"true\">,</mo><mn>000</mn></mrow><annotation encoding=\"application/x-tex\">N=10,000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">10</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">000</span></span></span></span>","key":"jVjJMa07hI"},{"type":"text","value":", ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"HNzPLI6pbx"},{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"McgwXeW26D"},{"type":"text","value":" is faster because it exploits the band structure of the full system. Our implementation allows ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"V1gUJQoSgG"},{"type":"inlineCode","value":"n_knots < N","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"Lp069go1hQ"},{"type":"text","value":" (Regression Splines), which restores speed (","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"lhHmCnC6ho"},{"type":"inlineMath","value":"O(N K^2)","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><msup><mi>K</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N K^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"DfJyHzPAOh"},{"type":"text","value":") and reduces overfitting risk, a feature ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"PXRCFmwHgC"},{"type":"inlineCode","value":"smooth.spline","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"daQUrDbgEU"},{"type":"text","value":" supports via ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"mPeAA32boF"},{"type":"inlineCode","value":"nknots","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"LVLPaWbnwN"},{"type":"text","value":".","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"td1Gdzzgml"}],"key":"TAGEkaNtGc"}],"key":"FPwWKviuKG"},{"type":"listItem","spread":true,"position":{"start":{"line":134,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"text","value":"Spar (R specific):","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"ZI6PziA4tO"}],"key":"PD3Gtylg2n"},{"type":"text","value":" R uses a scaling parameter ","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"lFn7plBGxR"},{"type":"inlineCode","value":"spar","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"hZXMrSw9U3"},{"type":"text","value":" related to ","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"AODvYLivi1"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"uRb4lrKurw"},{"type":"text","value":". We use raw ","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"x68OU2xT15"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"JcZjY94EP9"},{"type":"text","value":" (scaled by ","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"TAgsoAzG2W"},{"type":"inlineMath","value":"x","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"EAs1sSBHeh"},{"type":"text","value":"-range cubed for numerical stability).","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"Hi6iMbSt7l"}],"key":"u8FXiVQJ0f"}],"key":"fg35V80f2b"}],"key":"XLQXXVXu1o"},{"type":"heading","depth":2,"position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"5. References","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"uZyyQ4UWQS"}],"identifier":"id-5-references","label":"5. References","html_id":"id-5-references","implicit":true,"key":"NWYI6V4hVb"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":138,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Hastie, T., Tibshirani, R., & Friedman, J. (2009). ","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"kX7WT88oxx"},{"type":"emphasis","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"The Elements of Statistical Learning: Data Mining, Inference, and Prediction","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"PEUD1CQpOQ"}],"key":"HkxFcmABF4"},{"type":"text","value":". 2nd Edition. Springer. (Chapter 5).","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"kJjvzYlNgk"}],"key":"spa2qllI0K"}],"key":"Ftmv0Vspzj"},{"type":"listItem","spread":true,"position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Green, P. J., & Silverman, B. W. (1994). ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"l6ydVkUR7o"},{"type":"emphasis","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"Nonparametric Regression and Generalized Linear Models: A Roughness Penalty Approach","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"nYVu7uWBNe"}],"key":"i6aINsehje"},{"type":"text","value":". Chapman and Hall/CRC.","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"ueb36om2yc"}],"key":"VxxI7UIchu"}],"key":"e0tYt6UHDS"}],"key":"PbACUQkt6t"}],"key":"rSlNHxWnQu"}],"key":"mmQqZ3xtwG"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Smoothing Spline","url":"/","group":"Smoothing Spline"},"next":{"title":"Comparing smoothing_spline with R’s smooth.spline","url":"/compare-r","group":"Smoothing Spline"}}},"domain":"http://localhost:3000"}